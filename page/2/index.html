<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://cyysu.github.io">
  <title>运维技术</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="专注Linux运维技术 热爱开源">
<meta property="og:type" content="website">
<meta property="og:title" content="运维技术">
<meta property="og:url" content="http://cyysu.github.io/page/2/index.html">
<meta property="og:site_name" content="运维技术">
<meta property="og:description" content="专注Linux运维技术 热爱开源">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="运维技术">
<meta name="twitter:description" content="专注Linux运维技术 热爱开源">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.2d7529.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?260032afd54ad6c4bcd06ae61fa5febb";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/man.png" class="js-avatar show">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">lyx</a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/categories/Linux">运维</a></li>
	        
				<li><a href="/categories/oldLinux">笔记</a></li>
	        
				<li><a href="/categories/about">关于</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/cyysu" title="github"><i class="icon-github"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:2869905223@qq.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="jianshu" target="_blank" href="http://www.500d.me/resume/cyysu/" title="jianshu"><i class="icon-jianshu"></i></a>
		        
			</div>
		</nav>
	</header>
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/man.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">lyx</h1>
			</hgroup>
			
			
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/cyysu" title="github"><i class="icon-github"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:2869905223@qq.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="jianshu" target="_blank" href="http://www.500d.me/resume/cyysu/" title="jianshu"><i class="icon-jianshu"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 33.333333333333336%"><a href="/categories/Linux">运维</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/categories/oldLinux">笔记</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/categories/about">关于</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-8.Linux运维服务-DNS服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/8.Linux运维服务-DNS服务/">DNS服务</a>
    </h1>
  

        
        <a href="/2017/03/15/8.Linux运维服务-DNS服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.445Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</p>
<p>##声明</p>
<ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
<li><strong>本文内容如有不当之处，欢迎批评指正</strong></li>
<li><strong>文档书写风格  章节内的小节缩进2个tab，小节内容在章节的基础上缩进1个tab</strong></li>
</ul>
<p>##本文大纲</p>
<pre><code>1.开篇的话
2.DNS服务
3.案例
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-DNS服务"><a href="#2-DNS服务" class="headerlink" title="2.DNS服务"></a>2.DNS服务</h2><p><strong>简介</strong></p>
<pre><code>工作原理
    DNS服务概述：
        DNS（Domain Name System）域名系统，在TCP/IP 网络中有非常重要的地位，能够提供域名与IP地址的解析服务。

        DNS 是一个分布式数据库，命名系统采用层次的逻辑结构，如同一棵倒置的树，这个逻辑的树形结构称为域名空间，由于DNS 划分了域名空间，所以各机构可以使用自己的域名空间创建DNS信息。
        注：DNS 域名空间中，树的最大深度不得超过127 层，树中每个节点最长可以存储63 个字符。
基础知识
    1、域和域名
        DNS 树的每个节点代表一个域，通过这些节点，对整个域名空间进行划分，成为一个层次结构。
        域名空间的每个域的名字，通过域名进行表示。

        域名：通常由一个完全合格域名（FQDN）标识。FQDN能准确表示出其相对于DNS 域树根的位置，也就是节点到DNS 树根的完整表述方式，从节点到树根采用反向书写，并将每个节点用“.”分隔，对于DNS 域google 来说，其完全正式域名（FQDN）
        为google.com。
        例如，google为com域的子域，其表示方法为google.com，而www为google域中的子域，可以使用www.google.com表示。

        注意：通常，FQDN 有严格的命名限制，长度不能超过256 字节，只允许使用字符a-z,0-9,A-Z
        和减号（-）。点号（.）只允许在域名标志之间（例如“google.com”）或者FQDN 的结尾使用。
        域名不区分大小。
        由最顶层到下层，可以分成：根域、顶级域、二级域、子域。

        Internet 域名空间的最顶层是根域（root），其记录着Internet 的重要DNS 信息，由Internet域名注册授权机构管理，该机构把域名空间各部分的管理责任分配给连接到Internet 的各个组织。
         “.”全球有13个根(root)服务器
        DNS 根域下面是顶级域，也由Internet 域名注册授权机构管理。共有3 种类型的顶级域。
        组织域：采用3 个字符的代号，表示DNS 域中所包含的组织的主要功能或活动。比如com 为商业机构组织，edu 为教育机构组织，gov 为政府机构组织，mil 为军事机构组织，net 为网络机构组
        织，org 为非营利机构组织，int 为国际机构组织。

        地址域：采用两个字符的国家或地区代号。如cn 为中国，kr 为韩国，us 为美国。
        反向域：这是个特殊域，名字为in-addr.arpa，用于将IP 地址映射到名字（反向查询）。
        对于顶级域的下级域，Internet 域名注册授权机构授权给Internet 的各种组织。当一个组织获得了对域名空间某一部分的授权后，该组织就负责命名所分配的域及其子域，包括域中的计算机和其他设备，并管理分配的域中主机名与IP 地址的映射信息。

    2、区(Zone)
        区是DNS 名称空间的一部分，其包含了一组存储在DNS 服务器上的资源记录。
        使用区的概念，DNS 服务器回答关于自己区中主机的查询，每个区都有自己的授权服务器。

    3、主域名服务器与辅助域名服务器
        当区的辅助服务器启动时，它与该区的主控服务器进行连接并启动一次区传输，区辅助服务器定期与区主控服务器通信，查看区数据是否改变。如果改变了，它就启动一次数据更新传输。
        每个区必须有主服务器，另外每个区至少要有一台辅助服务器，否则如果该区的主服务器崩溃了，就无法解析该区的名称。
        辅助服务器的优点：

        1）容错能力
            配置辅助服务器后，在该区主服务器崩溃的情况下，客户机仍能解析该区的名称。一般把区的主
        服务器和区的辅助服务器安装在不同子网上，这样如果到一个子网的连接中断，DNS 客户机还能
        直接查询另一个子网上的名称服务器。

        2）减少广域链路的通信量
            如果某个区在远程有大量客户机，用户就可以在远程添加该区的辅助服务器，并把远程的客户机
        配置成先查询这些服务器，这样就能防止远程客户机通过慢速链路通信来进行DNS 查询。

        3）减轻主服务器的负载
            辅助服务器能回答该区的查询，从而减少该区主服务器必须回答的查询数。

    4、DNS 相关概念
        1）DNS 服务器
            运行DNS 服务器程序的计算机，储存DNS 数据库信息。DNS 服务器会尝试解析客户机的查询请求。
        在解答查询时，如果DNS 服务器能提供所请求的信息，就直接回应解析结果，如果该DNS 服务器
        没有相应的域名信息，则为客户机提供另一个能帮助解析查询的服务器地址，如果以上两种方法
        均失败，则回应客户机没有所请求的信息或请求的信息不存在。

        2）DNS 缓存
            DNS 服务器在解析客户机请求时，如果本地没有该DNS 信息，则可以会询问其他DNS 服务器，当
        其他域名服务器返回查询结果时，该DNS 服务器会将结果记录在本地的缓存中，成为DNS 缓存。
        当下一次客户机提交相同请求时，DNS 服务器能够直接使用缓存中的DNS 信息进行解析。

    5、DNS查询工作流程
        &lt;1&gt; 客户机提交域名解析请求，并将该请求发送给本地的域名服务器。
        &lt;2&gt; 当本地的域名服务器收到请求后，就先查询本地的缓存。如果有查询的DNS 信息记录，则直
        接返回查询的结果。如果没有该记录，本地域名服务器就把请求发给根域名服务器。
        &lt;3&gt; 根域名服务器再返回给本地域名服务器一个所查询域的顶级域名服务器的地址。
        &lt;4&gt; 本地服务器再向返回的域名服务器发送请求。
        &lt;5&gt; 接收到该查询请求的域名服务器查询其缓存和记录，如果有相关信息则返回客户机查询结
        果，否则通知客户机下级的域名服务器的地址。
        &lt;6&gt; 本地域名服务器将查询请求发送给返回的DNS 服务器。
        &lt;7&gt; 域名服务器返回本地服务器查询结果（如果该域名服务器不包含查询的DNS 信息，查询过程
        将重复&lt;6&gt;、&lt;7&gt;步骤，直到返回解析信息或解析失败的回应）。
        &lt;8&gt; 本地域名服务器将返回的结果保存到缓存，并且将结果返回给客户机。

    6、查询方式
        1）递归查询
            递归查询是一种DNS 服务器的查询模式，在该模式下DNS 服务器接收到客户机请求，必须使用一
        个准确的查询结果回复客户机。如果DNS 服务器本地没有存储查询DNS 信息，那么该服务器会询
        问其他服务器，并将返回的查询结果提交给客户机。

        2）迭代查询
            DNS 服务器另外一种查询方式为迭代查询，当客户机发送查询请求时，DNS 服务器并不直接回复查
        询结果，而是告诉客户机另一台DNS 服务器地址，客户机再向这台DNS 服务器提交请求，依次循环直到返回查询的结果为止。

    7、正向解析和反向解析

        1）正向解析
            正向解析是指域名到IP 地址的解析过程。

        2）反向解析
            反向解析是从IP 地址到域名的解析过程。反向解析的作用为服务器的身份验证。[http://dns.aizhan.com/](http://dns.aizhan.com/ &quot;反向解析网址&quot;)
</code></pre><p><strong>服务安装、启动和配置</strong></p>
<pre><code>服务安装
    yum install bind bind-chroot bind-utils   -y
    bind-9.7.3-8.P3.el6.x86_64.rpm   #该包为DNS 服务的主程序包。
    bind-chroot-9.7.3-8.P3.el6.x86_64.rpm   # 提高安全性。
    #bind-chroot是bind的一个功能,使bind可以在一个chroot 的模式下运行.也就是说,bind运行时的/(根)目录,并不是系统真正的/(根)目录,只是系统中的一个子目录而已.这样做的目的是为了提高安全性.因为在chroot的模式下,bind可以访问的范围仅限于这个子目录的范围里,无法进一步提升,进入到系统的其他目录中.
    bind-utils-9.7.3-8.P3.el6.x86_64.rpm  #该包为客户端工具，默认安装，用于搜索域名指令。


服务启动、端口检测和加入开机启动项

    cat /etc/services | grep 53,593

    ls /etc/named.conf
        /etc/named.conf
        named.conf 是BIND 的核心配置文件，它包含了BIND 的基本配置，但其并不包括区域数据。

    /etc/init.d/named restart   #重启服务

    netstat -antup | grep 53    #查看端口

服务配置

    开启named服务后，/var/named/chroot/目录下的文件会自动挂载，调用chroot功能切换根：


配置DNS服务器解析： xuegod.cn

    vim /var/named/chroot/etc/named.conf   #启动服务后，尽量使用这个路径。

    整体分3段

        zone        ： 针对某个区域生效

            重点说一下type参数：

            type 字段指定区域的类型，对于区域的管理至关重要，一共分为六种：

                1)Master：主DNS 服务器：拥有区域数据文件，并对此区域提供管理数据

                2)Slave：辅助DNS 服务器：拥有主DNS 服务器的区域数据文件的副本，辅助DNS 服务器会从主DNS服务器同步所有区域数据。

                3)Stub：stub 区域和slave 类似，但其只复制主DNS 服务器上的NS 记录而不像辅助DNS 服务器会复制所有区域数据。

                4)Forward：一个forward zone 是每个域的配置转发的主要部分。一个zone 语句中的type forward可以包括一个forward 和/或forwarders 子句，它会在区域名称给定的域中查询。如果没有forwarders 语句或者forwarders 是空表，那么这个域就不会有转发，消除了options 语句中有关转发的配置。

                5)Hint：根域名服务器的初始化组指定使用线索区域hint zone，当服务器启动时，它使用根线索来查找根域名服务器，并找到最近的根域名服务器列表。

    配置正向解析区域
    授权DNS 服务器管理xuegod.cn 区域，并把该区域的区域文件命名为xuegod.cn
</code></pre><h2 id="3-案例"><a href="#3-案例" class="headerlink" title="3.案例"></a>3.案例</h2><p><strong>例1：</strong></p>
<pre><code>分析：
</code></pre><hr>
<pre><code>方案：
</code></pre>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">DNS服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/8.Linux运维服务-DNS服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-7.Linux运维服务-FTP服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/7.Linux运维服务-FTP服务/">FTP服务</a>
    </h1>
  

        
        <a href="/2017/03/15/7.Linux运维服务-FTP服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.326Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来"><a href="#Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来" class="headerlink" title="Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)"></a>Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</h3><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.FTP服务
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-FTP服务"><a href="#2-FTP服务" class="headerlink" title="2.FTP服务"></a>2.FTP服务</h2><p><strong>简介</strong></p>
<pre><code>FTP服务器（File Transfer Protocol Server）是在互联网上提供文件存储和访问服务的计算机，它们依照FTP协议提供服务。
FTP（File Transfer Protocol: 文件传输协议）作用： Internet 上用来传送文件的协议
常见FTP服务器：
windows：Serv-U FTP Server
Linux：ProFTPD:（Professional FTP daemon）一个Unix平台上或是类Unix平台上（如Linux, FreeBSD等）的FTP服务器程序。

VSFTP是一个基于GPL发布的类Unix系统上使用的FTP服务器软件，它的全称是Very Secure FTP 从此名称可以看出来，编制者的初衷是代码的安全。
特点：
它是一个安全、高速、稳定的FTP服务器；

模式： C/S 模式

20 (传数据)   21 (传指令)
    fsp（File Service Protocol）： 文件服务协议。

ftp分为主动模式和被动模式

    这里的主动和被动，是相对于的FTP server 端来判断的。无论是被动还是主动模式，首先的控制通道都是先建立起来的，只有在数据传输模式上有区别
</code></pre><p><strong>工作原理</strong></p>
<p><strong>1.主动模式工作原理</strong></p>
<pre><code>FTP客户端链接到FTP服务器的21端口，发送用户名和密码，客户端随机开放一个端口(1024以上)发送PORT命令到FTP服务器，告诉服务器客户端采用主动模式开放端口；FTP服务器收到PORT主动模式命令和端口号后，通过服务器的20端口和客户端开放的端口链接，发送数据，原理如下：

        客户端                                                      服务器
                        FTP链接请求(用户名，密码，port端口)
                    --------------------------------------&gt;
                服务器相应(ACK) 服务端21号和客户端端口建立回话连接通道
                    &lt;---------------------------------------


             FTP服务器从自己的20号端口连接客户端指定端口连接请求为主动模式
                &lt;-------------------------------------------------
                            最后客户端发送ACK确认，开始数据传输
                -------------------------------------------------&gt;
</code></pre><p><strong>2.被动模式工作原理</strong></p>
<pre><code>FTP客户端链接到FTP服务器的21端口，发送用户名和密码，发送PASV命令到FTP服务器，服务器在本地随机开放一个端口(1024以上)，然后把开放的端口告诉客户端，客户端在链接到服务器开放的端口进行连接。原理如下：


        客户端                                                    服务器

                FTP连接请求(包括用户名，密码，发送被动链接PASV)
                -----------------------------------------&gt;
                ftp服务器响应ACK，服务器21号和客户端高位随机端口
                进行回话连接，建立通道。同时服务器告诉了客户端服
                务器开放的端口
                &lt;-----------------------------------------


                客户端从自己中的一个高位端口链接服务器开放的端口
         ------------------------------------------------------&gt;
                   服务器发送ACK响应给客户端，进行数据传输
         &lt;------------------------------------------------------
</code></pre><p><strong>服务安装、启动和配置</strong></p>
<pre><code>服务安装
    yum -y install vsftpd lftp

    注：从RHEL6开始，系统镜像中默认没有ftp客户端命令。取而代之的是lftp命令
    Linux客户端：
    lftp 是一个功能强大的下载工具，它支持访问文件的协议: ftp, ftps, http, https, hftp, fish.(其中ftps和https需要在编译的时候包含openssl库)。llftp的界面非常好一个shell: 有命令补全，历史记录，允许多个后台任务执行等功能，使用起来非常方便。它还有书签、排队、镜像、断点续传、多进程下载等功能。

服务启动和端口检测(注意将防火墙和selinux关闭)
    service vsftpd restart
    chkconfig vsftpd on
    netstat -antup | grep ftp

    这里我们会发现看不到20端口，那是因为服务器和客户端没有进行通信

服务配置
    /etc/vsftpd/vsftpd.conf：vsftpd 的核心配置文件
    /etc/vsftpd/ftpusers：用于指定哪些用户不能访问FTP 服务器。  黑名单
    /etc/vsftpd/user_list：指定允许使用vsftpd 的用户列表文件。  白名单
    vim  /etc/vsftpd/user_list
    /etc/vsftpd/vsftpd_conf_migrate.sh：是vsftpd 操作的一些变量和设置脚本
    /var/ftp/：默认情况下匿名用户的根目录
</code></pre><p><strong>案例</strong></p>
<p><strong>例1：公司技术部准备搭建一台功能简单的FTP 服务器，允许所有员工上传和下载文件，并允许创建用户自己的目录</strong></p>
<pre><code>分析：
    允许所有员工上传和下载文件需要设置成允许匿名用户登录并且需要将允许匿名用户上传功能开启，
</code></pre><hr>
<pre><code>方案：
    cp vsftpd.conf vsftpd.conf.back
    vim  /etc/vsftpd/vsftpd.conf  #修改以下内容

    #允许匿名用户访问
    anonymous_enable=YES
    #允许匿名用户上传文件并可以创建目录
    anon_upload_enable=YES
    #字段可以控制是否允许匿名用户创建目录
    anon_mkdir_write_enable=YES
</code></pre><p><strong>例2：公司内部现在有一台FTP 和WEB 服务器，FTP 的功能主要用于维护公司的网站内容，包括上传文件、创建目录、更新网页等等。公司现有两个部门负责维护任务，他们分别适用team1 和team2<br>帐号进行管理。先要求仅允许team1 和team2 帐号登录FTP 服务器，但不能登录本地系统，并将<br>这两个帐号的根目录限制为/var/www/html，不能进入该目录以外的任何目录</strong></p>
<pre><code>分析：
    将FTP 和WEB 服务器做在一起是企业经常采用的方法，这样方便实现对网站的维护，为了增强安
    全性，首先需要使用仅允许本地用户访问，并禁止匿名用户登录。其次使用chroot 功能将team1
    和team2 锁定在/var/www/html 目录下。如果需要删除文件则还需要注意本地权限
</code></pre><hr>
<pre><code>方案：
    1）建立维护网站内容的ftp 帐号team1 和team2 并禁止本地登录，然后设置其密码
        [root@xuegod63 ~]# useradd -s /sbin/nologin team1
        [root@xuegod63 ~]# useradd -s /sbin/nologin team2
        [root@xuegod63 ~]# echo &quot;123456&quot; | passwd --stdin team1
        Changing password for user team1.
        passwd: all authentication tokens updated successfully.
        [root@xuegod63 ~]# echo &quot;123456&quot; | passwd --stdin team2
        Changing password for user team2.
        passwd: all authentication tokens updated successfully.

    2）配置vsftpd.conf 主配置文件并作相应修改
        [root@xuegod63 vsftpd]# cp vsftpd.conf.back vsftpd.conf
        vim /etc/vsftpd/vsftpd.conf
        anonymous_enable=NO：禁止匿名用户登录
        local_enable=YES：允许本地用户登录

        local_root=/var/www/html
        chroot_list_enable=YES
        chroot_list_file=/etc/vsftpd/chroot_list

        #local_root=/var/www/html                        #设置本地用户的根目录为/var/www/html
        #chroot_list_enable=YES                            #激活chroot功能
        #chroot_list_file=/etc/vsftpd/chroot_list        #设置锁定用户在根目录中的列表文件。此文件存放要锁定的用户名

    3）建立/etc/vsftpd/chroot_list 文件，添加team1 和team2 帐号
        [root@xuegod63 vsftpd]# touch /etc/vsftpd/chroot_list
        [root@xuegod63 ~]# ll !$
        ll /etc/vsftpd/chroot_list
        -rw-r--r-- 1 root root 0 Nov 10 17:08 /etc/vsftpd/chroot_list
        [root@xuegod63 ~]# vim /etc/vsftpd/chroot_list  #写入以下内容，一行，一个用户名
        team1
        team2

    4）重启vsftpd 服务使配置生效
        service vsftpd restart

    5）修改本地权限
        [root@xuegod63 ~]# ll -d /var/www/html/
        drwxr-xr-x. 2 root root 4096 Oct  6  2011 /var/www/html/
        [root@xuegod63 ~]# chmod -R o+w /var/www/html/
        [root@xuegod63 ~]# ll -d /var/www/html/
        drwxr-xrwx. 2 root root 4096 Oct  6  2011 /var/www/html/
</code></pre><p><strong>例3:公司为了宣传最新的产品信息，计划搭建FTP 服务器，为客户提供相关文档的下载。对所有互<br>联网开放共享目录，允许下载产品信息，禁止上传。公司的合作单位能够使用FTP 服务器进行上<br>传和下载，但不可以删除数据。需要保证服务器的稳定性并做优化。创建ftp虚拟帐号。允许客户使用ftp帐号下载文件。 但是，你们自己的合作伙伴帐号：vip可以上传一内部文件</strong></p>
<pre><code>分析:
    根据企业的需求，对于不同用户进行不同的权限限制，FTP 服务器需要实现用户的审核。需考虑
    到服务器的安全性，所以关闭实体用户登录，使用虚拟帐号验证机制，并对不同虚拟帐号设置不
    同的权限。为了保证服务器的性能，还需要根据用户的等级，限制客户端的连接数及下载速度。
</code></pre><hr>
<pre><code>方案：

    1、创建用户数据库
        1）创建用户文本文件
            先建立用户文本文件vsftpd_virtualuser.txt，添加两个虚拟帐号，公共帐号ftp 及客户帐号
            vip
            [root@xuegod63 vsftpd]# vim /etc/vsftpd/vsftpd_virtualuser.txt  #写入以下内容。格式一行用户一行密码

            ftp     #客户用户
            123456  #密码
            vip        #合作伙伴
            123456

        2）生成数据库
            保存虚拟帐号和密码的文本文件无法被系统帐号直接调用。我们需要使用db_load 命令生成db数据库文件
            [root@xuegod63 vsftpd]# rpm -qf `which db_load `
            db4-utils-4.7.25-16.el6.x86_64

            # db_load -T -t hash -f /etc/vsftpd/vsftpd_virtualuser.txt  /etc/vsftpd/vsftpd_virtualuser.db
            参数说明：
            选项-T允许应用程序能够将文本文件转译载入进数据库。
            由于我们之虚拟用户信息，以文本文件存储的。为让Vsftpd应用程序能够通过来载入用户数据，必须要使用选项来转译成vsftpd可以读懂的内容
                -t hash使用hash码加密
                -f 指定包含用户名和密码文本文件。此文件格式要示：奇数行用户名、偶数行密码

            [root@xuegod63 vsftpd]# rm -rf /etc/vsftpd/vsftpd_virtualuser.txt   #为了安全，删除此文件。后期不再使用此文件。

         3）修改数据库文件访问权限
            数据库文件中保存着虚拟帐号的密码信息，为了防止非法用户盗取哈，我们可以修改该文件的访问权限。生成的认证文件的权限应设置为只对root用户可读可写，即600
            [root@xuegod63 vsftpd]# chmod 600 /etc/vsftpd/vsftpd_virtualuser.db
            [root@xuegod63 vsftpd]# ll !$
            ll /etc/vsftpd/vsftpd_virtualuser.db
            -rw------- 1 root root 12288 Nov 10 21:16 /etc/vsftpd/vsftpd_virtualuser.db

    2、配置PAM 文件
         为了使服务器能够使用数据库文件，对客户端进行身份验证，需要调用系统的PAM 模块.


            PAM(Plugable Authentication Module)为可插拔认证模块，不必重新安装应用系统，通过修
            改指定的配置文件，调整对该程序的认证方式。PAM 模块配置文件路径为/etc/pam.d/目录，此
            目录下保存着大量与认证有关的配置文件，并以服务名称命名。
            修改vsftpd 对应的PAM 配置文件/etc/pam.d/vsftpd。将默认配置使用“#”全部注释，添加两行应字段。

            [root@xuegod63 vsftpd]# cat /etc/pam.d/vsftpd
            ##%PAM-1.0
            #session    optional     pam_keyinit.so    force revoke
            #auth       required    pam_listfile.so item=user sense=deny file=/etc/vsftpd/ftpusers onerr=succeed
            #auth       required    pam_shells.so
            #auth       include    password-auth
            #account    include    password-auth
            #session    required     pam_loginuid.so
            #session    include    password-auth
            auth    required    /lib64/security/pam_userdb.so  db=/etc/vsftpd/vsftpd_virtualuser
            account    required    /lib64/security/pam_userdb.so  db=/etc/vsftpd/vsftpd_virtualuser

         注意：这里的db=/etc/vsftpd/vsftpd_virtualuser是pam文件的写法规范，不是真正指向db=/etc/vsftpd/vsftpd_virtualuser 这个文件，而是/etc/vsftpd/vsftpd_virtualuser.db 文件。与此同时还需要注意的是db=数据库中的数据库不用写出拓展名


    3、创建虚拟帐号对应的系统用户及ftp共享的目录
        对于公共帐号和客户帐号，因为需要配置不同的权限，所以可以将两个帐号的目录进行隔离，控
        制用户的文件访问。公共帐号ftp 对应系统帐号ftpuser，并指定其主目录为/var/ftp/share，
        而客户帐号vip 对应系统帐号ftpvip，指定主目录为/var/ftp/vip。

        [root@xuegod63 vsftpd]# useradd -d   /var/ftp/share     ftpuser
        [root@xuegod63 vsftpd]# useradd -d   /var/ftp/vip       ftpvip
        [root@xuegod63 vsftpd]# chmod -R 500 /var/ftp/share/  #修改权限
        [root@xuegod63 vsftpd]# chmod -R 700 /var/ftp/vip/

        chmod -R 500 /var/ftp/share/ ：公共帐号ftp 只允许下载，修改share 目录其他用户权限为rx 可读可执行。
        chmod -R 700 /var/ftp/vip/   ：客户帐号vip 允许上传和下载，所以对vip 目录权限设置为rwx，
        可读可写可执行。
        注：如果不设置可执行用户登录会出不能更改目录错误。

    4、建立配置文件

        互动：如何设置多个虚拟帐号的不同权限？ 以前都配置好服务后，对所有用户有效。现在需要对不同用户配置不同的权限。 怎么办？
        一个配置文件无法实现此功能，需要为每个虚拟帐号建立独立的配置文件，并根据需要进行相应的设置。

        1）修改vsftpd.conf 主配置文件
            配置主配置文件/etc/vsftpd/vsftpd.conf 添加虚拟帐号的共同设置并添加user_config_dir 字段，定义虚拟帐号的配置文件目录。
            开始配置：
            [root@xuegod63 vsftpd]# cp vsftpd.conf.back vsftpd.conf
            禁用匿名用户登录并启用本地用户登录设置
            vim vsftpd.conf
            改：
            anonymous_enable=YES
            为：
            anonymous_enable=NO

            local_enable=YES           #确认此选项打开，允许本地用户登录。 Uncomment ：取消注释
            chroot_local_user=YES   #确认此选项打开。将所有本地用户限制在家目录中，NO 则不限制
            pam_service_name=vsftpd  #确认在文件的最后有选项。配置vsftpd 使用的PAM 模块为vsftpd

            在此选项后面追加：
            user_config_dir=/etc/vsftpd/vuserconfig            #设置虚拟帐号的主目录为/vuserconfig
            max_clients=300                                    #设置FTP 服务器最大接入客户端数为300 个
            max_per_ip=10                                    #设置每个IP 地址最大连接数为10 个


        2）建立虚拟帐号配置文件
            在user_config_dir 指定路径下，建立与 **虚拟帐号** 同名 的配置文件并添加相应的配置字段

            首先建立公共帐号ftp 的配置文件
            [root@xuegod63 ~]# grep vuserconfig /etc/vsftpd/vsftpd.conf   #查看要创建的目录名
            user_config_dir=/etc/vsftpd/vuserconfig
            [root@xuegod63 ~]# mkdir /etc/vsftpd/vuserconfig
            [root@xuegod63 ~]# touch /etc/vsftpd/vuserconfig/ftp
            [root@xuegod63 ~]# touch /etc/vsftpd/vuserconfig/vip

            下面是客户的虚拟账号配置文件
                [root@xuegod63 ~]# vim /etc/vsftpd/vuserconfig/ftp
                guest_enable=yes
                guest_username=ftpuser
                anon_world_readable_only=no
                anon_max_rate=50000

            解释：
                guest_enable=yes：开启虚拟帐号登录
                guest_username=ftpuser：设置ftp 对应的系统帐号为ftpuser
                anon_world_readable_only=no：允许匿名用户浏览整个服务器的文件系统
                anon_max_rate=50000：限定传输速率为50KB/s
</code></pre><hr>
<pre><code>注意：
    vsftpd 对于文件传输速度限制并不是绝对锁定在一个数值上哈，而是在80%~120%之间变化
    比如设置100KB/s 则实际是速度在80KB/s~120KB/s 之间变化
</code></pre><hr>
<pre><code>      下面是合作伙伴的虚拟账号配置文件
          [root@xuegod63 ~]# vim /etc/vsftpd/vuserconfig/vip  #写入以下内容
          guest_enable=yes
          guest_username=ftpvip
          anon_world_readable_only=no
          write_enable=yes
          anon_mkdir_write_enable=yes
          anon_upload_enable=yes
          anon_max_rate=100000

      解释：
          guest_enable=yes：开启虚拟帐号登录
          guest_username=ftpvip：设置ftp 对应的系统帐号为ftpvip
          anon_world_readable_only=no：允许匿名用户浏览器整个服务器的文件系统
          write_enable=yes：允许在文件系统写入权限
          anon_mkdir_write_enable=yes：允许创建文件夹
          anon_upload_enable=yes：开启匿名帐号的上传功能
          anon_max_rate=100000：限定传输速度为100KB/s

5、重启 vsftpd 使配置生效
      [root@xuegod63 ~]# service vsftpd restart
</code></pre><p><strong>回顾配置文件参数</strong></p>
<pre><code>anonymous_enable=YES          #启用匿名用户（anonymous、ftp）
local_enable=YES              #本地用户、启用
write_enable=YES              #本地用户、可写
#anon_upload_enable=YES       #匿名用户可写
#anon_mkdir_write_enable=YES  #匿名用户可以创建目录
#idle_session_timeout=600     #超时时间
#data_connection_timeout=120  #超时时间
listen=YES                    #是否监听
pam_service_name=vsftpd       #开启pam支持
userlist_enable=YES           #用户列表功能开启
tcp_wrappers=YES              #开始tcp_wrappers支持
userlist_deny=NO              #黑名单变白名单



#锁定用户访问的目录：
chroot_local_user=NO
chroot_list_enable=YES
chroot_list_file=/etc/vsftpd/chroot_list　　　#写谁锁谁

chroot_local_user=YES
chroot_list_enable=YES
chroot_list_file=/etc/vsftpd/chroot_list　　　#写谁不锁谁

#其他功能：
#匿名用户可以重命名和删除：
#虚拟账号 pam认证
anon_other_write_enable＝YES
bind IP
listen_address=IP
local_max_rate=N
anon_max_rate=N
max_client=N
max_per_ip=N
</code></pre>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">FTP服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/7.Linux运维服务-FTP服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-6.Linux运维服务-Samba服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/6.Linux运维服务-Samba服务/">Samba服务</a>
    </h1>
  

        
        <a href="/2017/03/15/6.Linux运维服务-Samba服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.255Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来"><a href="#Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来" class="headerlink" title="Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)"></a>Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</h3><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.Samba服务
3.常见错误解决方案
4.应用场景
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-Samba服务"><a href="#2-Samba服务" class="headerlink" title="2.Samba服务"></a>2.Samba服务</h2><p><strong>简介</strong></p>
<pre><code>Samba服务概述：
    Samba 最先在Linux 和Windows 两个平台之间架起了一座桥梁，正是由于Samba 的出现，我们可以在Linux 系统和Windows 系统之间互相通信，比如拷贝文件、实现不同操作系统之间的资源共享等等，我们可以将其架设成一个功能非常强大的文件服务器，也可以将其架设成打印服务器提供本地和远程联机打印
</code></pre><p><strong>软件安装和启动</strong></p>
<pre><code>软件安装
    rpm -ivh /mnt/Packages/samba-3.5.10-114.el6.x86_64.rpm

服务启动
    service smb start 或 /etc/init.d/smb restart

samba 服务配置重新加载
    /etc/init.d/smb   reload

服务加入开机自启
    chkconfig smb on

查看端口
    netstat -antup | grep smb

windows访问samba服务的时候采用如下格式访问
    \\192.168.1.63

Linux访问的时候共享文件夹采用如下格式
    smbclient -L  samba IP    密码为空   这样查看的方式为匿名用户
    smbclient -L  samba IP -U 用户名%密码    以用户名查看samba共享文件
    smbclient //samba共享的绝对路径 -U 用户名%密码

如果登陆出现问题可以尝试清除一下缓存    (windows平台)
    net use * /del                      //显示已建立的远程连接并询问是否确认删除，输入y删除，输入n暂不删除
</code></pre><p><strong>配置文件解析</strong></p>
<pre><code>配置文件详解：/etc/samba/smb.conf

    1、samba 配置简介
        smb.conf 文件的开头部分为samba 配置简介，告诉我们smb.conf 文件的作用及相关信息。
        smb.conf 中还有以“;”开头，这些都是samba 配置的格式范例，默认是不生效滴，可以通过去掉前面的“;”并加以修改来设置想使用的功能。
        [root@xuegod63 ~]# vim /etc/samba/smb.conf  #搜索分号 ；
        ;       security = domain
        另外#号也是表示注示
    2、Global Settings

        Global Settings 设置为全局变量区域。全局变量就是说我们只要在global 时进行设置，那么该设置项目就是针对所有共享资源生效。这与以后我们学习的很多服务器配置文件相似。


    格式：
    字段=设定值
    下面我们说下[global]常用字段及设置方法：

    1）设置samba 服务器所在工作组或域名
    我们设置samba 服务器的工作组为xuegod.cn
           workgroup = xuegod.cn  #工作组
    2）服务器描述，服务器描述实际上类似于备注信息，
    设置samba 描述信息为“xuegod.cn Samba Server  ”。
            server string = xuegod.cn Samba Server  #samba服务器描述

    3、设置samba 服务器安全模式。常见模式有两种：share 安全级别模式和user 安全级别模式
        samba 服务器有share、user、server、domain 和AD活动目录 五种安全模式。
        （1）share 安全级别模式
        客户端登录samba 服务器，不需要输入用户名和密码就可以浏览samba 服务器的资源，适用于公
        共的共享资源，安全性差，需要配合其他权限设置，保证samba 服务器的安全性。
        （2）user 安全级别模式
        客户端登录samba 服务器，需要提交合法帐号和密码，经过服务器验证才可以访问共享资源，服务器默认为此级别模式。
    4、Share Definitions 共享服务的定义
        [homes]为特殊共享目录，表示用户主目录。
        [printers]表示共享打印机。

修改配置文件，实战举例：
     Samba 常规服务器配置
        基本的Samba服务器的搭建流程主要分为四个步骤：
        [1]、编辑主配置文件smb.conf,指定需要共享的目录，并为共享目录设置共享权限。
        [2]、在smb.conf 文件中指定日志文件名称和存放路径。
        [3]、设置共享目录的本地系统权限及samba共享权限。
        [4]、重新加载配置文件或重新启动smb 服务，使用配置生效


    配置一个共享资源：
        [share]  #设置共享名
                comment = Home Directories  #描述
                browseable = yes   #是否允许查看此共享内容 。如果是否，后期通过绝对路径，可以查看到。
        path = /share      #共享路径，写绝对路径
        public = yes  #允许匿名查看
        readonly = yes
    5、设置访问用户

        如果共享资源存在重要数据的话，需要对访问用户审核，我们可以使用valid users 字段进行设置
        格式：
        valid users = 用户名
        valid users = @组名

    6、设置目录只读
        共享目录如果限制用户的读写操作，我们可以通过readonly 实现哈~
        格式：
        readonly = yes #只读
        readonly = no #读写

    7、设置目录可写
        如果共享目录允许用户写操作，可以使用writable 或write list 两个字段进行设置
        writable 格式：
        writable = yes #读写
        writable = no #只读
        write list 格式：
        write list = 用户名
        write list = @组名

        Samba 服务日志文件
        在/etc/samba/smb.conf 文件中，log file 为设置samba 日志的字段。
</code></pre><p><strong>案例</strong></p>
<pre><code>    例1：匿名共享：

        公司现在用一个工作组xuegod.cn， 需要添加samba 服务器作为文件服务器，并发布共享目录/share，共享名为public,这个共享目录允许所有公司员工访问。


        [root@xuegod63 Desktop]# mkdir /share
        [root@xuegod63 Desktop]# cp /etc/passwd !$   #复制一个测试文件
        cp /etc/passwd /share

        vim /etc/samba/smb.conf
        [global]
                workgroup = xuegod.cn  #工作组
                server string = xuegod.cn Samba Server  #samba服务器描述
        security = share   # 允许匿名访问
        ============================ Share Definitions ====
        [share]  #设置共享名
                comment = Home Directories  #描述
        path = /share      #共享路径，写绝对路径
        public = yes  #允许匿名查看

        2）重新加载配置
        service smb restart

    例2：通过用户名和密码共享文件。把/sales  共享出去，只有知道用户名和密码的同事可以看这个共享。我们需要将全局配置中security 设置user 安全级别，然后在共享目录设置权限

    注意：一定要先指定存放密码的文件位置：


    1）添加销售部用户和组并添加相应samba 帐号

        使用groupadd 命令添加sales 组，然后执行useradd 命令和passwd 命令添加销售部员工的帐号及密码。

        [root@xuegod63 samba]# groupadd sales
        [root@xuegod63 samba]# useradd -g sales sale1
        [root@xuegod63 samba]# useradd -g sales sale2
        [root@xuegod63 samba]# id sale2
        uid=501(sale2) gid=500(sales) groups=500(sales)
        [root@xuegod63 samba]#

        接下来为销售部成员添加相应samba 帐号
        [root@xuegod63 samba]# smbpasswd -a sale1
        New SMB password:
        Retype new SMB password:
        startsmbfilepwent_internal: file /etc/samba/smbpasswd did not exist. File successfully created.
        Added user sale1.
        [root@xuegod63 samba]# ls /etc/samba/smbpasswd
        /etc/samba/smbpasswd
        [root@xuegod63 samba]# cat !$
        cat /etc/samba/smbpasswd
                sale1:500:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX:32ED87BDB5FDC5E9CBA88547376818D4:[U          ]:LCT-545E2105:
        [root@xuegod63 samba]# smbpasswd -a sale2
        New SMB password:
        Retype new SMB password:
        Added user sale2.

    2）修改samba 主配置文件smb.conf
        passdb backend = smbpasswd
        smb passwd file = /etc/samba/smbpasswd

例3:linux访问Windows共享文件的方法

    1、安装Samba服务
         yum install samba samba-client samba-swat

    2、启动Samba服务器
         /etc/init.d/smb restart

    3、安装cifs-utils，解决只读挂载

        yum install cifs-utils.x86_64

    4、把Windows共享文件夹挂载到linux 目录下

        mount -t cifs -o username=cnt01/njpublic,passwd=&apos;Welcome123&apos; //10.60.1.14/Files-Temporary-Transfer /mnt/

    注意挂载的格式：
    密码要 写在‘’ 里面，
    挂载的目录要写到上一级，//ip/共享文件夹
</code></pre><h2 id="3-常见错误解决方案"><a href="#3-常见错误解决方案" class="headerlink" title="3.常见错误解决方案"></a>3.常见错误解决方案</h2><p><strong>第一种问题</strong></p>
<p><strong>第二种问题</strong></p>
<h2 id="4-应用场景"><a href="#4-应用场景" class="headerlink" title="4.应用场景"></a>4.应用场景</h2><p><strong>1)文件和打印机贡献</strong><br>    文件和打印机共享是Samba 的主要功能，SMB 进程实现资源共享，将文件和打印机发布到网络之中，以供用户可以访问。</p>
<p><strong>2)身份验证和权限设置</strong><br>    smbd 服务支持user mode 和domain mode 等身份验证和权限设置模式，</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Samba服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/6.Linux运维服务-Samba服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-5.Linux运维服务-NFS服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/5.Linux运维服务-NFS服务/">NFS服务</a>
    </h1>
  

        
        <a href="/2017/03/15/5.Linux运维服务-NFS服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.196Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</p>
<p>##声明</p>
<ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.服务
3.常见错误解决方案
4.应用场景
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-NFS服务"><a href="#2-NFS服务" class="headerlink" title="2.NFS服务"></a>2.NFS服务</h2><p><strong>简介</strong></p>
<pre><code>NFS，是Network File System的简写，即网络文件系统。网络文件系统是FreeBSD支持的文件系统中的一种，也被称为NFS. NFS允许一个系统在网络上与他人共享目录和文件。通过使用NFS，用户和程序可以像访问本地文件一样访问远端系统上的文件。

模式： C/S 模式
端口：
RHEL6是以NFSv4作为默认版本，NFSv4使用TCP协议（端口号是2049）和NFS服务器建立连接
</code></pre><p><strong>软件安装和启动</strong></p>
<pre><code>软件安装
    yum -y install nfs*
    yum install mount        #用到showmount命令查看nfs的那些文件实现了贡献

端口检测和服务开启
    netstat -antpu | grep 2049
    service nfs start

加入开机自启
    chkconfig nfs on

查看NFS的贡献目录
    showmount -e NFS服务器IP

挂载文件
    mount 192.168.1.63:/tmp /opt
</code></pre><p><strong>触发式挂载</strong></p>
<pre><code>1.自动挂载
    vim  /etc/fstab
        192.168.30.128:/media    /opt        /nfs         defualts   0  0

2.安装软件 autofs

    yum install autofs -y
    autofs软件包要实现自动挂载涉及到两个文件，auto.master和auto.misc

    /etc/auto.master 文件定义本地挂载点.
    /etc/auto.misc 配置文件是用来设置需要挂载的文件系统类型和选项

            cd              -fstype=iso9660,ro,nosuid,nodev :/dev/cdrom
            *               -fstype=nfs,rw        192.168.0.62:/media

服务器端没有必要安装autofs  客户端安装nfs

重启服务
    service autofs restart
</code></pre><p><strong>配置文件解析</strong></p>
<pre><code>配置文件

        vim /etc/exports
        /media      *(rw)
        贡献目录

配置文件的简单配置

    /tmp/a/no_root_squash      *(rw,no_root_squash)
    /tmp/a/sync                192.168.0.0/24(rw,sync)
    /tmp/a/ro                  192.168.1.64(ro)
    /tmp/a/all_squash          192.168.0.0/24(rw,all_squash,anonuid=500,anongid=500)
    /tmp/a/async               192.168.3.0/255.255.255.0(async)
    /tmp/a/rw                  192.168.3.0/255.255.255.0(rw)    192.168.4.0/255.255.255.0(rw)
    /tmp/a/root_squash         *(rw,root_squash)

    * 表示所有网段
    sync/async:数据同步写入硬盘/不同步写入在内存中缓存
    root_squash（压制）：如果用root登录nfs，使其身份自动切换成nfsnobody。
    no_root_squash：如果用root登录nfs，使其身份就是root。
    all_squash：用户登录nfs时，指定身份为UID/GID的用户。

    注意：在发布共享目录的格式中除了共享目录是必跟参数外，其他参数都是可选的。并且共享
    目录与客户端之间及客户端与客户端之间需要使用空格符号，但是客户端与参数之间是不能有
    空格的

查看NFS的贡献目录
    showmount -e NFS服务器IP
</code></pre><h2 id="3-常见错误解决方案"><a href="#3-常见错误解决方案" class="headerlink" title="3.常见错误解决方案"></a>3.常见错误解决方案</h2><p><strong>第一种问题：共享目录之后无法创建文件</strong></p>
<pre><code>1、可能是服务器端文件自身的读写权限设置问题
    chmod 777 -R /贡献目录

2、chown nfsnobody:nfsnobody     /共享目录
</code></pre><p><strong>第二种问题：</strong></p>
<h2 id="4-应用场景"><a href="#4-应用场景" class="headerlink" title="4.应用场景"></a>4.应用场景</h2><p><strong>1)文件共享</strong></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">NFS服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/5.Linux运维服务-NFS服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-4.Linux运维服务-NTP服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/4.Linux运维服务-NTP服务/">NTP服务</a>
    </h1>
  

        
        <a href="/2017/03/15/4.Linux运维服务-NTP服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.154Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来"><a href="#Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来" class="headerlink" title="Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)"></a>Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</h3><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.NTP服务
3.常见错误解决方案
4.应用场景
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-NTP服务"><a href="#2-NTP服务" class="headerlink" title="2.NTP服务"></a>2.NTP服务</h2><p><strong>-简介</strong></p>
<pre><code>1、原理

    NTP（Network Time Protocol，网络时间协议）是用来使计算机时间同步化的一种协议。它可以使计算机对其服务器或时钟源做同步化，它可以提供高精准度的时间校正（LAN上与标准间差小于1毫秒，WAN上几十毫秒），且可介由加密确认的方式来防止恶毒的协议攻击。

    模式： C/S 模式
    运行模式：

2.服务安装和检查

    rpm -ivh /mnt/Packages/ntp-4.2.4p8-2.el6.x86_64.rpm 或 yum -y install ntp*

    service ntpd start

    netstat -anutp | grep 123

     ntpdate time.windows.com        #同步时间
    如果自己同步自己的话就会出现如下错误
    ntpdate time.windows.com

3.NTP服务器的主要配置文件

    /etc/ntp.conf：这个是NTP服务器的主要设文件，也是 NTP 唯一的设定文件
    下面重点说说 /etc/ntp.conf文件的设置。在 NTP Server 的设定上面，其实最好不要对 Internet 无限制的开放，尽量仅提供您自己内部的 Client 端联机进行网络校时就好。此外， NTP Server 总也是需要网络上面较为准确的主机来自行更新自己的时间，所以在我们的 NTP Server 上面也要找一部最靠近自己的 Time Server 来进行自我校正。事实上， NTP 这个服务和服务器之间，也是 C/S的一种模式。

    NTP服务器实际作用：保证Linux集群中所有所有服务器时间同步。 对于一个Linux集群，集群内的机器保持时间同步是很重要的，不然会出现很多问题。

    实例：配置一个本地时间同步服务器
    实验前请确保此服务器可以上网
    [root@xuegod63 ~]# vim /etc/ntp.conf   #修改以下√号标记内容，为自己需要的内存即可
    [root@xuegod63 ~]# vim /etc/ntp.conf   #修改以下√号标记内容，为自己需要的内存即可

    driftfile /var/lib/ntp/drift
    restrict default kod nomodify notrap nopeer noquery
    restrict -6 default kod nomodify notrap nopeer noquery
    restrict 127.0.0.1
    restrict -6 ::1
    √restrict 192.168.1.0 mask 255.255.255.0   # 允许192.168.1.0这个网段中的服务器，访问ntp服务器同步时间。
    √restrict 202.120.2.101   #允许单个IP地址方访问本服务器。

    server  202.120.2.101  #指定本NTP服务器的上游NTP服务器为202.120.2.101，并且设置为首先服务器。同步时间为，从上到下，写的越靠上，优先级越高。（写在所有server最前面IP地址为首先服务器，此服务器同步不了时间，寻找下一个NTP服务器）。此IP地址是上海交通大学网络中心NTP服务器地址。  在原配置文件中添加一个外网NTP服务器
    server 0.rhel.pool.ntp.org
    server 1.rhel.pool.ntp.org
    server 2.rhel.pool.ntp.org

    注意：有的老系统里，有下面这两行配置。如何有，就启动这两行，如果没有，可以跳过


    配置文件参数说明：
    # 1. 关于权限设定部分
    #权限的设定主要以 restrict 这个参数来设定，主要的语法为：
    #restrict IP mask netmask_IP parameter （pəˈramitər ：参数）
    #其中 IP 可以是IP地址，也可以是 default ，default 就类似 0.0.0.0
    #至于 paramter 则有：

    #ignore　：关闭所有的 NTP 联机服务
    #nomodify：表示 Client 端不能更改 Server 端的时间参数，不过， Client 端仍然可以透过 Server 端来进行网络校时。
    #notrust ：该 Client 除非通过认证，否则该 Client 来源将被视为不信任网域
    #noquery ：不提供 Client 端的时间查询
    #notrap ：不提供trap这个远程事件登入 。 不提供trap这个远程事件登陆（remote event logging)的功能。
    #如果 paramter 完全没有设定，那就表示该 IP (或网域)“没有任何限制”

    restrict default nomodify notrap noquery　# 关闭所有的 NTP 要求封包
    restrict 133.100.11.8
    #允许上游服务器133.100.11.8通过，并且指定上游服务器为133.100.11.8，并且设置为首先服务器。

    restrict 127.0.0.1　　　 #这是允许本机查询
    restrict 192.168.1.0  mask 255.255.255.0 nomodify
    #允许192.168.1.0/24网段内的客户端，通过这台NTP Server进行时间同步。
    #2. 上层主机的设定
    #要设定上层主机主要以 server 这个参数来设定，语法为：
    #server [IP|HOST Name]
    #Server 后面接的就是我们上层 Time Server 啰！同步时间为，从上到下，写的越靠上，优先级越高。server 0.pool.ntp.org
    server 1.pool.ntp.org
    server 2.pool.ntp.org
    server cn.pool.ntp.org prefer

    #其他设置值，以系统默认值即可
    #　另外，为了解决更新时间封包的传送延迟动作， 　所以可以使用 driftfile 来规定我们的主机
    #　在与 Time Server 沟通时所花费的时间，可以记录在 driftfile
    #　后面接的文件内，例如下面的范例中，我们的 NTP server 与   cn.pool.ntp.org联机时所花费的时间会记录在 /etc/ntp/drift文件内
    driftfile /var/lib/ntp/drift
    例：cat  /var/lib/ntp/drift    #只有ntp服务工作正常后，这个文件中才有内容。

4.启动的流程

    在启动NTP服务前，先对提供服务的这台主机手动的校正一次时间。有时，你的时间和NTP服务器时间相差太大，NTP会以你当前系统时间为准，不作同步。（因为启动服务器，端口会被服务端占用，就不能手动同步时间了）

    ntpdate time.windows.com

    然后在启动服务
    service ntpd start 或 /etc/init.d/ntpd start

    查看端口是否服务启动成功
    netstat -ln|grep 123

    确认我们的NTP服务器已经更新了自己的时间
    ntpstat #如果出现一下信心那么就代表成功了
    synchronized to NTP server(127.127.1.0) at stratum 11  #可以看到我们当前在11层。
    time correct to within 950ms   # ms毫秒是一种较为微小的时间单位，是一秒的千分之一。
    polling（轮询） server every 64 s

5.NTP服务同步硬件时间

    最后提及一点，ntp服务，默认只会同步系统时间。如果想要让ntp同时同步硬件时间，可以设置/etc/sysconfig/ntpd 文件。
    在/etc/sysconfig/ntpd文件中，添加 SYNC_HWCLOCK=yes 这样，就可以让硬件时间与系统时间一起同步。
    如下：
    [root@desktop2 ~]# cat /etc/sysconfig/ntpd //允许BIOS与系统时间同步
    # Drop root to id &apos;ntp:ntp&apos; by default.
    SYNC_HWCLOCK=yes
    OPTIONS=&quot;-u ntp:ntp -p /var/run/ntpd.pid -g&quot;
</code></pre><h2 id="3-常见错误解决方案"><a href="#3-常见错误解决方案" class="headerlink" title="3.常见错误解决方案"></a>3.常见错误解决方案</h2><p><strong>第一种问题：no server suitable for synchronization found</strong></p>
<pre><code>其实，这不是一个错误。而是由于每次重启NTP服务器之后大约要3－5分钟客户端才能与server建立正常的通讯连接。当此时用客户端连接服务端就会报这样的信息。一般等待几分钟就可以了。
</code></pre><p><strong>第二种问题：unsynchronised     polling server every 64 s</strong></p>
<pre><code>1、    在启动服务之前，先要手动同步下时间，系统时间和硬件时间都要同步
2、    修改配置文件，在定义server 字段下添加两行：
    server  127.127.1.0
    fudge   127.127.1.0 stratum 10
    server127.127.1.0 如果上面的服务器都无同步时间，就和本地系统时间同步。 127.127.1.0在这里是一个IP地址，不是网段。
    fudge127.127.1.0 stratum 10 #  127.127.1.0 为第10层。 ntp和127.127.1.0同步完后，就变成了11层。  ntp是层次阶级的。同步上层服务器的stratum 大小不能超过或等于16。

如果没有以上两个错误，可以不用添加这两行，按照上面的笔记配置即可
</code></pre><h2 id="4-应用场景"><a href="#4-应用场景" class="headerlink" title="4.应用场景"></a>4.应用场景</h2><p><strong>1)集群应用</strong></p>
<p><strong>2)内网NTP服务器</strong></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">NTP服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/4.Linux运维服务-NTP服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-3.Linux运维服务-RSYNC服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/3.Linux运维服务-RSYNC服务/">RSYNC服务</a>
    </h1>
  

        
        <a href="/2017/03/15/3.Linux运维服务-RSYNC服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.109Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来"><a href="#Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来" class="headerlink" title="Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)"></a>Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</h3><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.RSYNC服务
3.Rysnc特性和优点
</code></pre><hr>
<h2 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h2><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-简介"><a href="#2-简介" class="headerlink" title="2.简介"></a>2.简介</h2><pre><code>RSYNC=Remote Sync 远程同步   高效，一定要结合shell
官方网站：https://rsync.samba.org/
Author：     Andrew Tridgell, Wayne Davison, and others
                     Andrew Tridgell是Samba项目的领导者和主要开发人员，同时还在参与开发rsync、Linux Kernel。

与SCP的比较：scp=无法备份大量数据，类似windows的复制
 rsync=边复制 ，边统计，边比较
</code></pre><h2 id="3-Rysnc特性和优点"><a href="#3-Rysnc特性和优点" class="headerlink" title="3.Rysnc特性和优点"></a>3.Rysnc特性和优点</h2><pre><code>可以镜像保存整个目录树和文件系统。
可以很容易做到保持原来文件的权限、时间、软硬链接等等。
无须特殊权限即可安装。

快速：第一次同步时 rsync 会复制全部内容，但在下一次只传输修改过的文件。
压缩传输：rsync 在传输数据的过程中可以实行压缩及解压缩操作，因此可以使用更少的带宽。

安全：可以使用scp、ssh等方式来传输文件，当然也可以通过直接的socket连接。
支持匿名传输，以方便进行网站镜象。
选择性保持：符号连接，硬链接，文件属性，权限，时间等
</code></pre><hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">RSYNC服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/3.Linux运维服务-RSYNC服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-2.Linux运维服务-DHCP服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/2.Linux运维服务-DHCP服务/">DHCP服务</a>
    </h1>
  

        
        <a href="/2017/03/15/2.Linux运维服务-DHCP服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:48.058Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</p>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2/27/2017 5:38:32 PM</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.DHCP服务
3.常见错误解决方案
4.应用场景
5.和windows server的异同
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外
如果公司对DHCP服务器系统没有要求 那么建议用windows搭建
</code></pre><h2 id="2-DHCP服务"><a href="#2-DHCP服务" class="headerlink" title="2.DHCP服务"></a>2.DHCP服务</h2><p><strong>-简介</strong></p>
<pre><code>名称：DHCP  - Dynamic Host Configuration Protocol  动态主机配置协议
功能：DHCP(Dynamic Host Configuration Protocol，动态主机配置协议)是一个局域网的网络协议，使用UDP协议工作， 主要有两个用途：

    1、    给内部网络或网络服务供应商自动分配IP地址，主机名，DNS服务器，域名
    2、    配合其它服务，实现集成化管理功能。如：无人执守安装服务器

特点： C/S 模式
    自动分配IP地址，方便管理
    DHCP不会同时租借相同的IP地址给两台主机；
    DHCP管理员可以约束特定的计算机使用特定的IP地址；
    可以为每个DHCP作用域设置很多选项；
    客户机在不同子网间移动时不需要重新设置IP地址。每次都自动获取IP地址就可以了。
    DHCP的缺点:
    当网络上存在多服务器时，一个DHCP服务器不能查出已被其它服务器租出去的IP地址；
    DHCP服务器不能跨路由器与客户机通信，除非路由器允许BOOTP协议转发。
端口：
    **DHCP服务使用：端口67(bootps) 68(bootpc) 。
</code></pre><p><strong>-DHCP工作原理</strong></p>
<pre><code>第一阶段：
        client -&gt;  发送 discover广播报 -&gt;server               #这个过程中只有dhcp server能响应
第二阶段：
        server -&gt;  发送 OFFER  -&gt;  client                  #如果局域网中有多台dhcp server 都会发给client一个offer  但是client只会选择第一个
第三阶段：
        client -&gt;  发送request -&gt;  server                 #client请求服务器
第四阶段：
        server -&gt;  发送ack -&gt; client                        #发送确认报文，并给予ip地址
第五阶段：当ip地址的租期到达一半的时候，就会发生续租报文
        client -&gt; 发送REQUEST(renew)  -&gt; server
第六阶段：
        server -&gt; ack  -&gt; client
</code></pre><p><strong>便于理解</strong></p>
<pre><code>为了便于理解，我们把DHCP客户机比做餐馆里的客人，DHCP服务器工作原理当中，服务器比做服务员（一个餐馆里也可以有多个服务员），IP地址比做客户需要的食物。那么可以这样描述整个过程：客人走进餐馆，问：“有没有服务员啊？”（DHCP discover），多个服务员同时回答：“有，我这有鸡翅”“有，我这有汉堡”（DHCP offer）。

客人说：“好吧，我要一份汉堡”（DHCP request，这个客人比较死板，总是选择第一次听到的食物），端着汉堡的服务员回应了一声：“来啦”（DHCP ack），并把食物端到客人面前，供其享用（将网卡和IP地址绑定）。客人下次来的时候，就直接找上次那个服务员点自己喜欢的汉堡了（DHCP request），如果还有汉堡，服务员会再次确认并上菜（DHCP ack），而如果已经卖完了，服务员则会告诉客人：“不好意思，已经卖完了”（DHCP nack）。

当然，服务员隔一段时间会来收拾一次桌子，除非客人特别说明这菜还要继续吃的，服务员会将剩菜端走。
</code></pre><p><strong>注意</strong></p>
<pre><code>客户端执行DHCP DISCOVER 后，如果没有DHCP 服务器响应客户端的请求，客户端会随机使用169.254.0.0/16 网段中的一个IP 地址配置本机地址
</code></pre><p><strong>-搭建服务</strong></p>
<pre><code>1.安装软件
    yum install -y dhcp

2.配置文件
    cp /usr/share/dhcpd.conf.sample /etc/dhcp/dhcpd.conf
    chkconfig dhcpd on
    配置完服务是启动不成功的,启动失败的原因是 dhcp服务器配置的IP地址和本地的ip地址分发是不相同。
    ##在启动DHCP服务之前，需要给DHCP Server配置一个静态的IP地址

3.配置文件解析
    DHCP配置文件参数说明
        1)、主配置文件介绍

            dhcp 范本配置文件内容包含了部分参数、声明以及选项的用法，其中注释部分可以放在任何位
            置，并以“#”号开头，当一行内容结束时，以“;”号结束，大括号所在行除外

            可以看出整个配置文件分成全局和局部两个部分。但是并不容易看出哪些属于参数，哪些属于声明和选项。

            概念与协议：
            作用域：可以分配IP的范围 subnet
            地址池：可以分配给客户端的IP，range包括的IP
            保留地址：指定某个客户端使用一个特定IP，通过host配置的
            租约(时间)：客户端可以使用这个IP地址的时间


        2)、配置文件：/etc/dhcp/dhcpd.conf     部分配置解释
            # option definitions common to all supported networks...    ＃定义全局配置，通用于所有支持的网络选项.
            option domain-name &quot;example.org&quot;;    #为客户端指定所属的域类似windows上的AD域
            option domain-name-servers ns1.example.org, ns2.example.org;  #为客户端指定DNS服务器地址


            default-lease-time 600;
                作用：定义默认IP 租约时间，以秒为单位的租约时间。
                50%:续约。(续不上继续用)
                87.5%:再次续约。(续不上找别人)
                DHCP工作站除了在开机的时候发出 DHCPrequest 请求之外，在租约期限一半的时候也会发出 DHCPrequest ，如果此时得不到 DHCP服务器的确认的话，工作站还可以继续使用该IP；当租约期过了87.5%时，如果客户机仍然无法与当初的DHCP服务器联系上，它将与其它 DHCP服务器通信。如果网络上再没有任何DHCP协议服务器在运行时，该客户机必须停止使用该IP地址，并从发送一个Dhcpdiscover数据包开始，再一次重复整个过程。要是您想退租，可以随时送出 DHCPRELEASE 命令解约，就算您的租约在前一秒钟才获得的。

            max-lease-time 7200;  (数字)
                作用：定义客户端IP租约时间的最大值，当客户端超过租约时间，却尚未更新IP 时，最长可以使用该IP 的时间；
                例：
                比如，机器在开机获得IP地址后，然后关机了。这时，当时间过了default-lease-time 600秒后，没有机器向DHCP续约，DHCP会保留7200秒，保留此IP地址不用于分配给其它机器。 当超过7200秒后，将不再保留此IP地址给此机器。
                注意:（3）、（4）都是以秒为单位的租约时间，该项参数可以作用在全局配置中，也可以作用在局部配置中。

            log-facility local7;   #定义日志类型为  local7

            subnet：

                声明一般用来指定IP 作用域、定义为客户端分配的IP 地址池等等
                声明格式如下：
                subnet 网络号 netmask 子网掩码 {
                选项或参数
                }

        3)、常见声明的使用如下：
            1) subnet 网络号 netmask 子网掩码 {......}
            作用:定义作用域，指定子网
            如：

            注意：网络号必须与DHCP 服务器的网络号相同

            下面介绍以下每个选项的含意：
                range 起始IP 地址 结束IP 地址
                    作用：指定动态IP 地址范围
                    注意：可以在subnet（子网） 声明中指定多个range，但多个range 所定义IP 范围不能重复

                常用选项介绍
                    选项通常用来配置DHCP 客户端的可选参数，比如定义客户端的DNS 地址、默认网关等等。选项
                    内容都是以option 关键字开始。
                    常见选项使用如下：
                              1）option routers IP 地址
                                作用：为客户端指定默认网关
                                如：option routers 10.5.5.1;

                            2）option domain-name
                                作用：为客户端指定默认的域

                            3) option domain-name-servers IP 地址
                                作用：为客户端指定DNS 服务器地址
                            注意：(1)、(2)、(3)选项可以用在全局配置中，也可以用在局部配置中。

4、常见的配置
    subnet 192.168.1.0 netmask 255.255.255.0 {
          range 192.168.1.100 192.168.1.200;
          option domain-name-servers 192.168.1.1;
          option domain-name &quot;xuegod.cn&quot;;
          option routers 192.168.1.1;
          option broadcast-address 192.168.1.255;
          default-lease-time 600;
          max-lease-time 7200;
    }
    配置完之后就可以重启网络服务

5.客户端配置
    在以上步骤配置完服务器端之后就可以配置客户端了，首先可以在客户端添加一份网卡，网卡设置为dhcp之后如果都配置正确的话重启网络服务就会产生ip地址

6.查看租期
    客户端文件存放在/var/lib/dhclient/dhclient-eth1.leases
服务器文件存放在/var/lib/dhcpd/dpcpd.leases

7.设置ip地址和MAC地址绑定在一起
    在DHCP 中的IP 地址绑定用于给客户端分配固定IP 地址。比如服务器需要使用固定IP 地址就可以使用IP 地址绑定，通过MAC 地址与IP 地址的对应关系为指定的物理地址计算机分配固定IP地址。整个配置过程需要用到 host 声明和hardware、fixed-address 参数。
            （1）host 主机名 {......}
                作用：用于定义保留地址
            （2）hardware 类型 硬件地址
                作用：定义网络接口类型和硬件地址。常用类型为以太网（ethernet）,地址为MAC 地址。
            （3）fixed-address IP 地址
                作用：定义DHCP 客户端指定的IP 地址。

 host xuegod63 {    #这一段内容，要写在subnet字段中，和subnet配合使用。
    hardware ethernet 00:0C:29:12:ec:1e;
    fixed-address 192.168.0.251;
  }
</code></pre><h2 id="3-常见错误解决方案"><a href="#3-常见错误解决方案" class="headerlink" title="3.常见错误解决方案"></a>3.常见错误解决方案</h2><p><strong>-错误解决方案</strong></p>
<pre><code>1.当配置文件复制完成之后，重启hdcpd服务发现无法启动
    启动失败的原因是 dhcp服务器配置的IP地址和本地的ip地址分发是不相同。
    ##在启动DHCP服务之前，需要给DHCP Server配置一个静态的IP地址

2.在配置dhcpd.conf文件的时候，当到达句尾一定不要忘记“;”

3.如果服务一直启动不成功，仔细检查配置文件，尤其是ip地址的网段
</code></pre><h2 id="4-应用场景"><a href="#4-应用场景" class="headerlink" title="4.应用场景"></a>4.应用场景</h2><p><strong>-主要应用</strong></p>
<pre><code>1、    给内部网络或网络服务供应商自动分配IP地址，主机名，DNS服务器，域名
2、    配合其它服务，实现集成化管理功能。如：无人执守安装服务器
</code></pre><h2 id="5-windows-server的异同"><a href="#5-windows-server的异同" class="headerlink" title="5.windows server的异同"></a>5.windows server的异同</h2><p>由于本人不擅长windows server知识，但是为了大家方便给大家找了一些文章</p>
<p>1.<a href="http://blog.chinaunix.net/uid-29178012-id-3963202.html" title="windows server AD" target="_blank" rel="external">http://blog.chinaunix.net/uid-29178012-id-3963202.html</a></p>
<p>2.<a href="http://jingyan.baidu.com/article/c275f6bacef120e33d756701.html" title="在Windows Server中怎么安装DHCP服务" target="_blank" rel="external">http://jingyan.baidu.com/article/c275f6bacef120e33d756701.html</a></p>
<p>3.<a href="http://blog.csdn.net/yuanguozhengjust/article/details/37512269" title="Windows Server上的DHCP配置 " target="_blank" rel="external">http://blog.csdn.net/yuanguozhengjust/article/details/37512269</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">DHCP服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/2.Linux运维服务-DHCP服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-11.Linux运维服务-Postfix服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/11.Linux运维服务-Postfix服务/">Postfix服务</a>
    </h1>
  

        
        <a href="/2017/03/15/11.Linux运维服务-Postfix服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:44.663Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#YSU-Linux运维笔记模板V3.0</p>
<p><strong>编辑软件：MarkdownPad2</strong></p>
<p><strong>撰写人员：Kali</strong></p>
<p><strong>撰写日期：2017年3月5日</strong></p>
<p><strong>联系作者：cyysu.github.io@gmail.com</strong></p>
<p><strong>友情提示：文章内容如有不对，欢迎指正。</strong></p>
<hr>
<h2 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1 开篇的话"></a>1 开篇的话</h2><h3 id="1-1-学习方法"><a href="#1-1-学习方法" class="headerlink" title="1.1 学习方法"></a>1.1 学习方法</h3><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h2 id="2-Postfix服务"><a href="#2-Postfix服务" class="headerlink" title="2 Postfix服务"></a>2 Postfix服务</h2><h3 id="2-1-简介"><a href="#2-1-简介" class="headerlink" title="2.1 简介"></a>2.1 简介</h3><pre><code>postfix是Wietse Venema在IBM的GPL协议之下开发的MTA（邮件传输代理）软件。postfix是Wietse Venema想要为使用最广泛的sendmail提供替代品的一个尝试。
在Internet世界中，大部分的电子邮件都是通过sendmail来投递的，大约有100万用户使用sendmail，每天投递上亿封邮件。这真是一个让人吃惊的数字。
Postfix试图更快、更容易管理、更安全，同时还与sendmail保持足够的兼容性

其它邮件服务器：
Sendmail、Qmail、Postfix
Sendmail的不足
　第一个重要的缺点是它的安全性较差，这是因为当其作者Eric Allman最初开始写作这个软件的时候，Internet的用户还很少，因而安全性并不没有得到大家的重视。
由于邮件系统需要处理的是外部发送来的各种各样的信息，甚至包含一些恶意数据，然而sendmail在大多数系统中都是以root身份运行，一旦出现问题，就会对系统安全造成严重影响。在这种情况下，要防止出现安全问题，仅仅依赖程序本身是不可取的，应该从系统结构出发，使程序拥有的特殊权限限制到最小。
第二个，使用Sendmail还会遇到的另一个问题是它的设置相当复杂，对于使用缺省设置来收发电子邮件，问题并不存在。当管理员打算进行一些特殊设置，以便利用Sendmail提供的复杂邮件处理能力时，就不得不面对复杂的宏和正则表达式。

Qmail可以替代Sendmail
Qmail，为了解决sendmail的安全问题，整个系统结构需要重新设计。基本的原则是将系统划分为不同的模块，有负责接收外部邮件的，有管理缓冲目录中待发送的邮件队列的，有将邮件发送到远程服务器或本地用户的。Qmail就是按照这个原则进行的设计，它由多个不同功能的小程序组成，只有必要的程序才是setuid程序(即以root用户权限执行)，这样就减少了安全隐患，并且由于这些程序都比较简单一些，因此就可以达到较高的安全性。


今天的主角：
另一种替换软件:Postfix  可以替代sendmail
　　Postfix同样也是采用了模块化的方式，但与Qmail不同的是，Postfix使用了一个主控进程进行监控。Postfix在很多方面都考虑到了安全问题，它甚至不向root分发电子邮件，以避免以root身份读写文件或启动外部程序。考虑到它的作者Wietse Venema曾编写了著名的安全软件TcpWrapper，Postfix的安全性是非常值得信赖的。
Postfix的性能也非常不错，甚至在Qmail作者自己进行的测试中也表明，Postfix的性能和Qmail基本相当。postfix在性能上大约比sendmail快三倍。


Dovecot: 邮件接收服务器：
    Dovecot 是一个开源的 IMAP 和 POP3 邮件服务器，支持 Linux/Unix 系统。
    POP / IMAP4 是 MUA 从邮件服务器中读取邮件时使用的协议。
    POP3 是从邮件服务器中下载邮件存起来，IMAP 则是将邮件留在服务器端直接对邮件进行管理、操作。比POP3更先进。
    由 Timo Sirainen 开发，最初发布于 2002年7月。作者将安全性考虑在第一，所以 Dovecot 在安全性方面比较出众。
    IMAP4是TCP/IP协议族中的一员，现在的版本是“IMAP第四版第一次修订版”。
    一个完整的邮件服务器由以下内容构成：

    postfix（作为发送邮件服务器）+dovecot（作为接收邮件服务器）+mysql（作为数据库）

    可以通过foxmail或outlook客户端。也可以通过网页来收邮件。



    邮件服务协议和端口：

        25 端口：SMTP协议。
            SMTP（Simple Mail Transfer Protocol）即简单邮件传输协议,它是一组用于由源地址到目的地址传送邮件的规则，由它来控制信件的中转方式。
        作用：此协议主要用来发送或中转邮件。SMTP协议属于TCP/IP协议簇，

        邮件服务中：
            发送： 指的是同属于163邮件服务器两人相互发送邮件。
            中转： 使用163邮箱给QQ邮箱发送邮件。

        24端口：LMTP(Local Mail Transfer Protocol)[1]，是本地邮件传输协议，与SMTP类似，但不支持邮件队列（queue），主要应用于非广域网的邮件网关。


        110端口：POP3协议
            POP3(Post Office Protocol 3)即邮局协议的第3个版本，它是规定个人计算机如何连接到互联网上的邮件服务器进行收邮件的协议。
        还有POP2协议。


        143端口：IMAP
            IMAP： （Internet Mail Access Protocol Internet邮件访问协议） 。IMAP是斯坦福大学在1986年开发的一种邮件获取协议。它的主要作用是邮件客户端（例如Outlook)可以通过这种协议从邮件服务器上获取邮件的信息，下载邮件等。

        当前的权威定义是RFC3501。IMAP协议运行在TCP/IP协议之上，使用的端口是143。它与POP3协议的主要区别是用户可以不用把所有的邮件全部下载，可以通过客户端直接对服务器上的邮件进行操作。他们之间的区别如下:
</code></pre><p><img src="http://omutvk8c2.bkt.clouddn.com/3.png" alt="pop3和IMAP的区别"><br><img src="http://omutvk8c2.bkt.clouddn.com/4.jpg" alt="邮件的工作流程"></p>
<pre><code>1：发件人写邮件，通过客户端连接邮件服务器，这个之间使用了 SMTP 协议链接！用
户就是 SMTP  客户端，发送服务器就是我们这儿的 SMTP 服务器！
2：SMTP  检查我们进入的邮件，将其放到邮件缓冲队列中，等待发送到接受服务器中， 这里要注意，postfix 在这里会检查我们是是否发给自己，若是发给自己的，那么就直接进入 了我们服务器自己的 mailbox！
3：发送服务器此时充当 SMTP 客户端，接受服务器充当 SMTP 服务端，建立 TCP 链接， 将邮件发送的接受服务器！
4：接受服务器收到邮件之后，把邮件里面的内容读取，如收件人信息   to:……
5：收件人打开客户端，使用 POP3 或者 IMAP 协议收取邮件并读取！
</code></pre><h3 id="2-2-服务安装、启动和配置"><a href="#2-2-服务安装、启动和配置" class="headerlink" title="2.2 服务安装、启动和配置"></a>2.2 服务安装、启动和配置</h3><pre><code>服务安装

    在安装之前首先要检查一下系统是否已经安装了Sendmail。

        rpm -qa | grep sendmail     #查看是否安装 sendmail
        yum remove sendmail -y      #卸载 sendmail

    下面就开始安装服务
         yum install -y postfix dovecot



服务启动、端口检测和加入开机启动项

    service postfix restart
    chkconfig postfix  on
     netstat -antup | grep 25

服务配置

    /etc/postfix/main.cf     #主配置文件位置
    /var/log/maillog         #日志文件位置
    /var/spool/mail/         #邮件存放位置，对应有相应用户名

配置文件部分参数

    [root@xuegod63 ~]# cp /etc/postfix/main.cf /etc/postfix/main.cf.bak
    [root@xuegod63 ~]# vim /etc/postfix/main.cf
    queue_directory = /var/spool/postfix   #队列目录
    command_directory = /usr/sbin     #命令位置目录
    mail_owner = postfix              #postfix运行身份
    myhostname = xuegod63.cn        #发送邮件时的名字，服务器名字
    mydomain = xuegod63.cn           #邮件域，用于接受的时候用
    myorigin = $mydomain             #我来自哪儿，别人收到的时候知道是我发送的
    inet_interfaces = localhost          #邮件接受监控的地址
    inet_protocols = all                #启用IPV4和IPV6
    mydestination = $myhostname, $mydomain, localhost          #服务器负责那些域
    mynetworks = 192.168.0.0/24, 127.0.0.0/8                 #指定允许使用的IP地址段
    alias_maps = hash:/etc/aliases                             #对某一个用户发，里面的人都可以收到邮件
    alias_database = hash:/etc/aliases
    #home_mailbox = Mailbox                                   #收件箱存放位置
</code></pre><h2 id="3-精彩案例"><a href="#3-精彩案例" class="headerlink" title="3 精彩案例"></a>3 精彩案例</h2><h3 id="3-1-配置postfix邮件服务器，实现邮件发送功能。"><a href="#3-1-配置postfix邮件服务器，实现邮件发送功能。" class="headerlink" title="3.1 配置postfix邮件服务器，实现邮件发送功能。"></a>3.1 配置postfix邮件服务器，实现邮件发送功能。</h3><pre><code>修改主机名和对应关系：
[root@xuegod63 postfix]# hostname
xuegod63.cn
[root@xuegod63 postfix]# cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.1.63   xuegod63.cn
192.168.1.64   xuegod64.cn

vim /etc/sysconfig/network
NETWORKING=yes
HOSTNAME=xuegod63.cn

[root@xuegod63 ~]# vim /etc/postfix/main.cf
需要启用和修改的项：
myhostname = xuegod63.cn  #指定邮件服务器名字，接收用来识别的，也就是一个标识
mydomain = xuegod63.cn   #邮件域
myorigin = $mydomain  #启用，去掉注释，发信地址，此设置显示为@xuegod63.cn
inet_interfaces = all  #对外提供MTA服务设置为监听所有网卡，默认只监听本地
#inet_interfaces = localhost  #这个注释起来，是默认值，只监控本地
mydestination = $myhostname, localhost.$mydomain, localhost  #此行不用改，但是要说明，这是代表邮件服务器负责的那些域
mynetworks_style = subnet #允许转发的来源网段，可选subnet子网，class网段，host本机
mynetworks = 192.168.0.0/24, 127.0.0.0/8 #用户允许的使用的IP地址段
relay_domains = $mydestination  #允许转发的目标域
local_recipient_maps =  #含有所有本地邮件地址的查询表.SMTP server借此拒收外界寄给不明用户的邮件，启用即可
alias_maps = hash:/etc/aliases  #对某个用户发，文件中的用户都可以收到邮件，别名组
alias_database = hash:/etc/aliases  #别名数据库
smtpd_banner = $myhostname ESMTP &quot;Welcome XueGod63.cn STMP Server&quot;  #自定义服务器信息

重启服务：
[root@xuegod63 ~]# service postfix start
[root@xuegod63 ~]# netstat -antup | grep 25


测试：

    mail -s &apos;Postfix1&apos; 3402301871@qq.com &lt; /etc/hosts
    tail -f /var/log/maillog
    在postfix的日志里：
    如果status=sent表示已经成功发送。removed表示从队列中删除发送的邮件
    如果status= deferred表示延期，需要重试，当重试到一定次数，还失败就抛弃
</code></pre>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Postfix服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/11.Linux运维服务-Postfix服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-10.Linux运维服务-自动化安装服务器" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/10.Linux运维服务-自动化安装服务器/">自动化部署</a>
    </h1>
  

        
        <a href="/2017/03/15/10.Linux运维服务-自动化安装服务器/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:44.645Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#YSU-Linux运维笔记模板V3.0</p>
<p><strong>编辑软件：MarkdownPad2</strong></p>
<p><strong>撰写人员：Kali</strong></p>
<p><strong>撰写日期：2017年3月5日</strong></p>
<p><strong>联系作者：cyysu.github.io@gmail.com</strong></p>
<p><strong>友情提示：文章内容如有不对，欢迎指正。</strong></p>
<hr>
<p><strong>PXE简介</strong></p>
<pre><code>严格来说，PXE 并不是一种安装方式，而是一种引导的方式。进行 PXE 安装的必要条件是要安装的计算机中包含一个 PXE 支持的网卡（NIC），即网卡中必须要有 PXE Client。PXE （Pre-boot Execution Environment）协议使计算机可以通过网络启动。

协议分为 client 和 server 端，PXE client 在网卡的 ROM 中，当计算机引导时，BIOS 把 PXE client 调入内存执行，由 PXE client 将放置在远端的文件通过网络下载到本地运行。

运行 PXE 协议需要设置 DHCP 服务器 和 TFTP 服务器。DHCP 服务器用来给 PXE client（将要安装系统的主机）分配一个 IP 地址，由于是给 PXE client 分配 IP 地址，所以在配置 DHCP 服务器时需要增加相应的 PXE 设置。
此外，在 PXE client 的 ROM 中，已经存在了 TFTP Client。PXE Client 通过 TFTP 协议到 TFTP Server 上下载所需的文件。
</code></pre><p><strong>KickStart</strong></p>
<pre><code>KickStart是一种无人职守安装方式。KickStart的工作原理是通过记录典型的安装过程中所需人工干预填写的各种参数，并生成一个名为 ks.cfg的文件；在其后的安装过程中（不只局限于生成KickStart安装文件的机器）当出现要求填写参数的情况时，安装程序会首先去查找 KickStart生成的文件，当找到合适的参数时，就采用找到的参数，当没有找到合适的参数时，才需要安装者手工干预。

这样，如果KickStart文件涵盖了安装过程中出现的所有需要填写的参数时，安装者完全可以只告诉安装程序从何处取ks.cfg文件，然后去忙自己的事情。等安装完毕，安装程序会根据ks.cfg中设置的重启选项来重启系统，并结束安装。
</code></pre><p><strong>PXE + KickStart安装需要准备内容</strong></p>
<pre><code>DHCP 服务器用来给客户机分配IP；
TFTP 服务器用来存放PXE的相关文件，比如：系统引导文件；
FTP 服务器用来存放系统安装文件；
KickStart所生成的ks.cfg配置文件；
带有一个 PXE 支持网卡的将安装的主机；
</code></pre><hr>
<p>##以上的基础知识已经讲完，现在就让我们动手来实践一下吧！</p>
<p><strong>配置基本环境</strong></p>
<h3 id="安装ftp服务"><a href="#安装ftp服务" class="headerlink" title="安装ftp服务"></a>安装ftp服务</h3><pre><code>yum install vsftpd -y
/etc/init.d/vsftpd start
chkconfig vsftpd on
</code></pre><h3 id="安装tftp服务"><a href="#安装tftp服务" class="headerlink" title="安装tftp服务"></a>安装tftp服务</h3><pre><code>yum install tftp tftp-server xinetd -y


配置tftp服务器：
vim /etc/xinetd.d/tftp
修改配置文件里面的13，14行.改成以下内容：

disable = no
server_args = -s /tftpboot  # 表示服务器默认的目录是 /tftpboot

启动服务
/etc/init.d/xinetd restart
lsof -i :69    #查看69端口正在被哪个进程使用
netstat -antup | grep 69   #这种方法，只能看到xinetd进程
</code></pre><h3 id="安装dhcp服务"><a href="#安装dhcp服务" class="headerlink" title="安装dhcp服务"></a>安装dhcp服务</h3><pre><code>yum install dhcp* -y

配置DHCP服务器：
cp /usr/share/doc/dhcp-4.1.1/dhcpd.conf.sample /etc/dhcp/dhcpd.conf

在配置DHCP服务器的时候可以不用在加一张网卡，可以直接使用本机的网卡。这里为了使用Xshell在加一张网卡，但是和实际中都是一样的。

给DHCP服务器添加一张VMNET4网卡，ip设置为192.168.1.10（只要是1网段都行）
ifconfig eth1 192.168.1.10/24


vim /etc/dhcp/dhcpd.conf  #这里为了简便，只保留一个subnet {。。。} ，取掉其它subnet，改成如下内容：


subnet 192.168.1.0 netmask 255.255.255.0 {
   range 192.168.1.100 192.168.1.200;
 option domain-name-servers 192.168.1.1;
  option domain-name &quot;internal.example.org&quot;;
  option routers 192.168.1.1;
  option broadcast-address 192.168.1.255;
  default-lease-time 600;
  max-lease-time 7200;
  next-server 192.168.1.10;
  filename &quot;pxelinux.0&quot;;
}


在配置上面的文件的时候一定要注意每行的结尾处要加上分号。配置完，先不启动DHCP ，等所有的软件安装好，最后来启动。
</code></pre><h3 id="安装PXE"><a href="#安装PXE" class="headerlink" title="安装PXE"></a>安装PXE</h3><pre><code>yum -y install system-config-kickstart  #安装此包时，会把syslinux软件包也安装上。

准备tftp需要共享出去的文件

mount /dev/sr0 /media/

mkdir /tftpboot
mkdir /tftpboot/pxelinux.cfg
cp /usr/share/syslinux/pxelinux.0     /tftpboot/
cp /media/images/pxeboot/initrd.img /tftpboot/
cp /media/images/pxeboot/vmlinuz     /tftpboot/
cp /media/isolinux/isolinux.cfg     /tftpboot/pxelinux.cfg/default
chmod 644 /tftpboot/pxelinux.cfg/default


修改default，指定安装操作系统的方式和ks.cfg文件路径
vim /tftpboot/pxelinux.cfg/default
#修改第1行 改为 default  linux,后面的linux意思是寻找下面18行的label linux
然后修改下22行（即在后面添加ks=ftp://192.168.1.10/ks.cfg）
第22行的意思是使安装程序通过FTP服务器访问kickstart文件
</code></pre><h3 id="制作kickstart安装向导"><a href="#制作kickstart安装向导" class="headerlink" title="制作kickstart安装向导"></a>制作kickstart安装向导</h3><pre><code> yum install system-config-kickstart -y
 LANG=zh_CN.UTF-8
 system-config-kickstart  #执行system-config-kickstart弹出来界面。
    1.设置下默认安装的语言，时区，根口令，然后勾选下面的安装后重新引导
    2.配置ftp服务器的安装方法。修改FTP服务器和FTP根目录为/pub
    3.配置grub相关选项
    4.设置分区
    5.配置网络，默认没有网络设置，点击添加网络，设备名称为eth0，网络类型为dhcp
    6.验证，默认就可以了。
    7.防火墙和selinux根据自己需求选择开启或者禁用。我选择关闭selinux。启用防火墙。
    8.安装图形环境选择禁用
    9.自定义软件包。默认可能没有勾选桌面。根据自己需求勾选。 我们为了快速度演示安装，不选择安装桌面。
    10.安装脚本：在&quot;预安装脚本&quot;，&quot;安装后脚本&quot;对话框中，可以分别添加在安装前、安装后自动动行的可执行语句。此项设置可以使服务器自动化配置变得更加容易。
    11.保存文件 -&gt; 点击左上角的文件选择保存，选择下保存的路径
cp ks.cfg /var/ftp  #复制ks.cfg文件到/var/ftp目录下
注：ks.cfg就是无人值守安装时要用的Kickstart文件。
要对应：/tftpboot/pxelinux.cfg/default文件中设置过ks=ftp://192.168.1.10/ks.cfg
mount /dev/sr0 /var/ftp/pub             #挂载RHEL6安装光盘到/var/ftp/pub目录下
建议关闭防火墙和selinux，
如果没有关闭的话，tftp服务会有问题。
[root@xuegod63 ~]# getenforce
Disabled
设置防火墙：
#iptables -F
#service iptables save
配置两台机器的网络模式为：VMnet4
给server 设置一个和DHCP 定义相同网段的IP
</code></pre><p>#现在接下来就是启动DHCP，设置为开机启动<br>    /etc/init.d/dhcpd start<br>    chkconfig dhcpd on<br>    修改另一台机器的BIOS启动顺序为网络优先，加电后开始启动。</p>
<h1 id="整个过程工作原理"><a href="#整个过程工作原理" class="headerlink" title="整个过程工作原理"></a>整个过程工作原理</h1><p><img src="http://omutvk8c2.bkt.clouddn.com/2.jpg" alt="工作原理"></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">自动化部署</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/10.Linux运维服务-自动化安装服务器/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-1.Linux运维服务-SSH服务" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/1.Linux运维服务-SSH服务/">SSH服务</a>
    </h1>
  

        
        <a href="/2017/03/15/1.Linux运维服务-SSH服务/" class="archive-article-date">
  	<time datetime="2017-03-15T11:13:44.621Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来"><a href="#Linux运维笔记-就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来" class="headerlink" title="Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)"></a>Linux运维笔记(就老男孩运维28期、马哥教育、学神IT、老段带你学Linux、Linux-Cast整理而来)</h3><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><ul>
<li><strong>“-“ 后面接的是段落小节标题</strong></li>
<li><strong>笔记按照服务一般配置整理</strong></li>
<li><strong>本文采用软件为 MarkdownPad2进行编辑</strong></li>
<li><strong>本文记录时间 2017-02-27 10:24:24</strong></li>
<li><strong>请将本文ip替换成自己的ip</strong></li>
</ul>
<h2 id="本文大纲"><a href="#本文大纲" class="headerlink" title="本文大纲"></a>本文大纲</h2><pre><code>1.开篇的话
2.SSH服务
3.排错
4.SSH调优
</code></pre><hr>
<h4 id="1-开篇的话"><a href="#1-开篇的话" class="headerlink" title="1.开篇的话"></a>1.开篇的话</h4><pre><code>学习Linux服务的大体流程如下

    了解服务的作用：名称，功能，特点
    安装
    配置文件位置，端口
    服务启动关闭的脚本
    此服务的使用方法
    修改配置文件，实战举例
    排错(从下到上，从内到外)
</code></pre><h4 id="2-SSH服务"><a href="#2-SSH服务" class="headerlink" title="2.SSH服务"></a>2.SSH服务</h4><p><strong>- 了解服务</strong></p>
<pre><code>SSHD服务，在我们的linux服务器上经常用到，很重要，涉及到服务器的安全，对这个服务的安全配置要高度重视

SSH 协议：安全外壳协议。为 Secure Shell 的缩写。SSH 为建立在应用层和传输层基础上的安全

sshd服务使用SSH协议可以用来进行远程控制， 或在计算机之间传送文件相比较之前用telnet方式来传输文件要安全很多，因为telnet使用明文传输，是加密传输。
</code></pre><p><strong>- 服务安装</strong></p>
<pre><code>第一步 ： 准备安装的软件包
        openssh-5.3p1-114.el6_7.x86_64：包含OpenSSH 服务器及客户端需要的核心文件
        openssh-clients-5.3p1-114.el6_7.x86_64：OpenSSH 客户端软件包
        openssh-server-5.3p1-114.el6_7.x86_64：OpenSSH 服务器软件包
        openssh-askpass-5.3p1-114.el6_7.x86_64：支持对话框窗口的显示，是一个基于X 系统的密码诊断工具

第二步 ：安装软件
        1.使用yum安装
            yum list all | grep openssh         # 查看是否有需要的软件包
            yum install openssh* -y             # 安装
        2.使用rpm安装
            rpm -ivh /media/cdrom/Packages/openssh*.rpm

        这里推荐使用yum安装

第三步： 检查软件是否安装
        rpm -qa | grep openssh                     #查看软件包
        rpm -ql openssh                         #查看软件安装目录
        netstat -ntulp | grep 22                #通过端口查看软件是否开启

第四步： 启动服务
        service sshd restart                    #重启服务
        chkconfig sshd on                         #加入开机自启
        chkconfig --list sshd                    #查看是否配置开机自启成功



第五步： 远程登陆
        1.ssh  [远程主机用户名] @[远程服务器主机名或IP地址]
            ssh 192.168.200.100
            ssh root@192.168.200.100
            ssh root@192.168.200.100 -p 22
            ssh -l root 192.168.200.100            #注意没有@符号
        2.第一次登录服务器时系统没有保存远程主机的信息，为了确认该主机身份会提示用户是否续连接，输入yes 后登录这时系统会将远程服务器信息写入用户主目录下的$HOME/.ssh/known_hosts 文件中，下次再进行登录时因为保存有该主机信息就不会再提示了

        3.远程登录以普通用户登陆
            useradd cat &amp;&amp; echo 123456 | passwd --stdin cat
            ssh -l cat 192.168.200.100
</code></pre><p><strong>- 配置文件</strong></p>
<pre><code>OpenSSH 配置文件
    OpenSSH 常用配置文件有两个 /etc/ssh/ssh_config 和 /etc/sshd_config
        ssh_config 为客户端配置文件
        sshd_config 为服务器端配置文件
</code></pre><p><strong>服务脚本 线上一般配置(实战)</strong></p>
<pre><code>常用的启动脚本主要有以下两个
    /etc/init.d/sshd restart/stop/start/status
    service sshd restart/stop/start/status
</code></pre><p><strong>注意事项</strong></p>
<pre><code>1.参数前面有#，表示是默认值。当然#号也表示注释
2.登录系统的默认日志存放在哪？
    sshd服务日志存放在： /var/log/secure
    由于这个文件/etc/rsyslog.conf  定义的sshd服务的日志存放位置？
        # The authpriv file has restricted access.
        authpriv.*                                              /var/log/secure
3.修改配置文件要重启服务
</code></pre><p><strong>/etc/ssh/sshd_config 配置文件</strong></p>
<pre><code>1.Port 22  -&gt;  设置sshd 监听端口号
    # SSH 预设使用 22 这个port，也可以使用多个port，即重复使用 port 这个设定项目！
    # 例如想要开放 sshd 端口为 22和 222 ，则多加一行内容为： Port 222  即可
    # 然后重新启动 sshd 这样就好了。 建议大家修改 port number 为其它端口。防止别人暴力破解。
2.ListenAddress 0.0.0.0  -&gt;  设置sshd监听ip地址
    # 设置sshd 服务器绑定的IP 地址，0.0.0.0 表示侦听所有地址
    # 比如192.168.0.63 这个机器只允许0.64来远程登录，那么可以设置
    # ListenAddress 192.168.0.64
3.Protocol 2  -&gt;  设置sshd的协议的版本号
    # 选择的 SSH 协议版本，可以是 1 也可以是 2 ，CentOS 5.x 预设是仅支援 V2。 安全考虑，设置为最新的协议版本
4.#HostKey /etc/ssh/ssh_host_key  -&gt;  设置sshd登陆密钥文件
    # 设置包含计算机私人密匙的文件
5.SyslogFacility AUTHPRIV    -&gt;    设置日志登陆信息
    # 当有人使用 SSH 登入系统的时候，SSH 会记录信息，这个信息要记录的类型为AUTHPRIV。
6.#LogLevel INFO
    # 登录记录的等级！INFO级别以上。
    [关于系统日志的文章](http://blog.csdn.net/beckdon/article/details/32696047 &quot;Linux系统日志&quot;)
</code></pre><p><strong>涉及到安全调优的配置选项</strong></p>
<pre><code>7.LoginGraceTime 2m       #grace 优雅
# 当使用者连上 SSH server 之后，会出现输入密码的画面，在该画面中，
# 在多久时间内没有成功连上 SSH server 就强迫断线！若无单位则默认时间为秒！ 可以根据实际情况来修改实际

8.# PermitRootLogin yes
# 是否允许 root 登入！预设是允许的，但是建议设定成 no！真实的生产环境服务器，是不允许root账号登陆的！！！


9.PasswordAuthentication yes
# 密码验证当然是需要的！所以这里写 yes，也可以设置为no。在真实的生产服务器上，根据不同安全级别要求，有的是设置不需要密码登陆的，通过认证的秘钥来登陆

10.# PermitEmptyPasswords no
# 若上面那一项如果设定为 yes 的话，这一项就最好设定为 no ，
# 这个项目在是否允许以空的密码登入！当然不许！

11.# PrintMotd yes
# 登入后是否显示出一些信息呢？例如上次登入的时间、地点等等，预设是 yes
# 亦即是打印出 /etc/motd 这个文档的内容。
例：给sshd服务添加一些警告信息
    cat /etc/motd
    echo &apos;Warning ! From now on, all of your operation has been 4record!&apos;&gt; /etc/motd
测试：
    ssh 192.168.0.64
    root@192.168.0.64&apos;s password:
    Last login: Thu Jun 23 14:02:38 2016 from 192.168.0.1
    Warning ! From now on, all of your operation has been record!

12.# PrintLastLog yes
    # 显示上次登入的信息！预设也是 yes  ！
    例：
    ssh 192.168.0.63
    Last login: Tue Nov  4 19:57:31 2014 from 192.168.1.107  #就是这个信息

13.# UseDNS yes
     # 一般来说，为了要判断客户端来源是正常合法的，因此会使用 DNS 去反查客户端的主机名
     # 不过如果是在内网互连，这项目设定为 no 会让联机速度比较快。
</code></pre><p><strong>3.排错</strong></p>
<pre><code>1.防火墙和selinux关闭
2.软件是否安装、服务是否开启以及端口是否在监听
3.配置文件是否修改  比如 端口号
4.分析日志文件
</code></pre><p><strong>4.SSHD防止暴力破解</strong></p>
<p><strong>配置文件</strong></p>
<pre><code>1.通过修改配置文件，密码的长度最好大于20位密码复杂度要尽可能有数字、大小写字母和特殊符号混合组成(kepass软件记录软件)

2.修改默认端口号

3.不允许root用户登陆

4.不允许密码登陆，只能通过密钥登陆系统客户端生成密钥对，然后将公钥上传到服务器   ssh-keygen创建私钥默认放在 /root/.ssh/id_rsa,并且需要设置密码来保护客户端私钥的密码，公钥保存在/root/.ssh/id_rsa.pub

    &gt;传输方法    ssh-copy-id -i 服务器
    &gt;在服务器上,服务器会将其替换成了.ssh/authorized_keys和在客户端上的公钥一致
</code></pre><p><strong>开源防护工具  fail2ban</strong></p>
<pre><code>fail2ban可以监视你的系统日志，然后匹配日志的错误系你想执行相应的屏蔽工作，而且可以发送e-mail通知系统管理员，工作的原理是通过分析一定时间内的相关服务日志，将满足动作的相关IP利用iptables加入到dorp列表一定时间。 使用该软件iptables必须要开启，如果ssh配置文件中的端口号发生改变需要更改/etc/fail2ban/jail.conf以及/对应action.d/iptables.conf文件

注：重启iptables服务的话，所有DORP将重置。
</code></pre><p><strong>fail2ban的安装、使用和配置</strong></p>
<pre><code>1.下载位置
    http://www.fail2ban.org

2.解压软件包和安装
     tar  -zxvf fail2ban-0.8.14.tar.gz -C /usr/local/src

3.执行安装，在安装之前首先检查一下python的版本
    python -V
    python setup.py install

4.目录解释，其配置文件为jail.conf
    /etc/fail2ban/action.d              #动作文件夹，内含默认文件。iptables以及mail等动作配置
    /etc/fail2ban/fail2ban.conf            #定义了fai2ban日志级别、日志位置及sock文件位置
    /etc/fail2ban/filter.d              #条件文件夹，内含默认文件。过滤日志关键内容设置
    /etc/fail2ban/jail.conf                #主要配置文件，模块化。主要设置启用ban动作的服务及动作阀值

5.加入系统启动服务中
    cp files/redhat-initd  /etc/init.d/fail2ban
    chkconfig --add fail2ban  #开机自动启动

    查找一个软件中的启动脚本文件的小方法：
        grep chkconfig  ./* -R --color  #启动脚本文件都是含有chkconfig

6.实例文件/etc/fail2ban/jail.conf及说明
    [DEFAULT]               #全局设置
    ignoreip = 127.0.0.1/8       #忽略的IP列表,不受设置限制
    bantime  = 600               #屏蔽时间，单位：秒
    findtime  = 600              #这个时间段内超过规定次数会被ban掉
    maxretry = 3                 #最大尝试次数
    backend = auto               #日志修改检测机制（gamin、polling和auto这三种）

    #单个服务检查设置，如设置bantime、findtime、maxretry和全局冲突，服务优先级大于全局设置。

    [sshd]
    enabled  = true              #是否激活此项（true/false）修改成 true
    filter   = sshd              #过滤规则filter的名字，对应filter.d目录下的sshd.conf
    action   = iptables[name=SSH, port=ssh, protocol=tcp]             #动作的相关参数，对应action.d/iptables.conf文件
    sendmail-whois[name=SSH, dest=you@example.com, sender=fail2ban@example.com, sendername=&quot;Fail2Ban&quot;]   #触发报警的收件人
    logpath  = /var/log/secure   #检测的系统的登陆日志文件。这里要写sshd服务日志文件。 默认为logpath  = /var/log/sshd.log
    #5分钟内3次密码验证失败，禁止用户IP访问主机1小时。 配置如下
    bantime  = 3600     #禁止用户IP访问主机1小时
    findtime  = 300     #在5分钟内内出现规定次数就开始工作
    maxretry = 3        #3次密码验证失败

如果遇到不能发送邮件的首先要确定sendmail可以发送右键，测试代码如下
    echo &quot;Hello World&quot; | mail -s test xxx@xxx.com

如果遇到本机不能远程登陆，那么只需要将ssh的日志文件删除即可   也就是/var/log/secure文件内容清除
    &gt; /var/log/secure

7.启动服务
    service fail2ban start

8.查看服务状态和防火墙是否设置了相关条目
    iptables -L -n
    fail2ban-client status                    #查看该软件是否工作
    #具体看某一项的状态也可以看，如果显示被ban的ip和数目就表示成功了，如果都是0，说明没有成功。相关代码如下
    fail2ban-client status ssh-iptables
</code></pre><p><strong>xinetd服务</strong></p>
<pre><code>xinetd(eXtended InterNET services daemon)  扩展因特网服务守护进程，是新一代的网络守护进程服务程序，又叫超级Internet服务器
作用： 通过xinetd服务来管理多种轻量级Internet服务。如： telnet、rsync、 tftp服务等。并为这些服务提供安全访问控制功能。
</code></pre>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">CentOS6.8</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">SSH服务</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/oldLinux/" class="article-tag-list-link color4">oldLinux</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/15/1.Linux运维服务-SSH服务/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 lyx
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.2d7529.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>
<script src="/js/jquery.min.js"></script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div id="totop" style="position:fixed;bottom:50px;right:30px;cursor: pointer;">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>
<script src="/js/totop.js"></script>
    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">CentOS6.8</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">SSH服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">自动化部署</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Postfix服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">NFS服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">RSYNC服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">NTP服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">DHCP服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Samba服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">FTP服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">DNS服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Gitlab</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">源码安装</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Apache服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">互联网资源</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">编程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">运维</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">IT</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">程序员</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">LAMP</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">WEB服务器</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">博客</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">LNMP</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">大学</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">markdown</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">跨平台</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Nagios</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">监控</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Linux服务</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">邮件服务</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="https://www.aliyun.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>阿里云</a>
            </li>
          
            <li class="search-li">
              <a href="http://bbs.hh010.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>鸿鹄论坛</a>
            </li>
          
            <li class="search-li">
              <a href="http://baiduyun.57fx.cn/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>百度云搜索</a>
            </li>
          
            <li class="search-li">
              <a href="https://github.com/search?utf8=%E2%9C%93&q=&type=Repositories&ref=searchresults" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Github搜索</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">毕业于燕山大学&lt;br&gt;热爱技术&lt;br&gt;热爱开源&lt;br&gt;</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>